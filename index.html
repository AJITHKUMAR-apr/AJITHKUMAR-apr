<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Anu & Aji ‚Äî Valentine's Surprise</title>

  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg1:#11021d; --bg2:#29102a;
      --accent:#ff6b9a; --accent-2:#ffb3c7; --muted:#ffdfe8;
      --card: rgba(255,255,255,0.03);
    }
    html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial;color:#fff;background:linear-gradient(180deg,var(--bg1),var(--bg2));-webkit-font-smoothing:antialiased}
    /* Top floating answer panel */
    .top-panel{
      position:fixed; left:50%; transform:translateX(-50%); top:18px;
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      padding:10px 18px; border-radius:999px; display:flex; gap:12px; align-items:center;
      box-shadow: 0 8px 30px rgba(0,0,0,0.5); z-index:100;
      backdrop-filter: blur(6px);
      pointer-events:auto;
      transition: transform 220ms ease;
      overflow:hidden; /* used so No button can be partly moved out */
    }
    .top-panel .label{font-weight:700;margin-right:8px;color:#fff}
    .panel-btn{padding:10px 14px;border-radius:999px;border:none;font-weight:800;cursor:pointer;font-size:0.95rem}
    .panel-btn.yes{background:linear-gradient(180deg,var(--accent),#ff3b78);color:#fff}
    .panel-btn.no{background:linear-gradient(180deg,#ffdee6,#ffd0df);color:#6b0020}
    /* main container */
    .container{max-width:1100px;margin:84px auto 28px;padding:26px;border-radius:16px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));box-shadow:0 12px 40px rgba(0,0,0,0.6);position:relative;overflow:hidden}
    header{display:flex;align-items:center;justify-content:space-between;gap:18px}
    .brand{display:flex;gap:12px;align-items:center}
    .mark{width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,var(--accent),var(--accent-2));display:flex;align-items:center;justify-content:center;font-family:'Playfair Display',serif;font-size:20px;color:#fff}
    nav a{color:rgba(255,255,255,0.9);text-decoration:none;margin-left:12px;font-weight:600}
    .hero{display:grid;grid-template-columns:1fr 380px;gap:26px;align-items:center;margin-top:20px}
    @media(max-width:920px){.hero{grid-template-columns:1fr}.hero-right{order:2}}
    h1{font-family:'Playfair Display',serif;font-size:2.4rem;margin:0 0 8px}
    .lead{color:var(--muted);margin-bottom:12px}
    .card{background:var(--card);padding:18px;border-radius:12px;box-shadow:0 8px 30px rgba(0,0,0,0.45);text-align:center}
    .cta-row{display:flex;gap:12px;justify-content:center;margin-top:12px;flex-wrap:wrap}
    .btn{padding:12px 18px;border-radius:999px;border:none;font-weight:800;cursor:pointer}
    .btn.yes{background:linear-gradient(180deg,var(--accent),#ff3b78);color:#fff}
    .btn.no{background:linear-gradient(180deg,#ffdee6,#ffd0df);color:#6b0020}
    .grid-2{display:grid;grid-template-columns:1fr 1fr;gap:18px;margin-top:18px}
    @media(max-width:920px){.grid-2{grid-template-columns:1fr}}
    .section{background:var(--card);padding:16px;border-radius:10px}
    .gallery{display:grid;grid-template-columns:repeat(3,1fr);gap:8px}
    @media(max-width:920px){.gallery{grid-template-columns:repeat(2,1fr)}}
    .photo{height:110px;border-radius:8px;background:linear-gradient(135deg, rgba(255,107,154,0.12), rgba(255,200,220,0.04));display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700;overflow:hidden}
    .prompt{position:fixed;left:14px;top:14px;background:rgba(0,0,0,0.44);padding:10px 12px;border-radius:10px;color:#fff;backdrop-filter:blur(6px);font-weight:700;display:none;z-index:200}
    .hearts{position:absolute;inset:0;pointer-events:none;overflow:hidden;border-radius:16px}
    .heart{position:absolute;width:18px;height:18px;opacity:0.95;animation:float linear infinite}
    @keyframes float{from{transform:translateY(40vh) rotate(0deg);opacity:0}20%{opacity:0.9}to{transform:translateY(-120vh) rotate(360deg);opacity:0}}
    canvas.confetti{position:absolute;inset:0;pointer-events:none;border-radius:16px}
    footer{margin-top:20px;text-align:center;color:rgba(255,255,255,0.85);font-size:0.92rem}
    img.responsive{width:100%;height:100%;object-fit:cover;display:block}
    /* subtle animation for No button movement hint */
    .no-hint { transition: transform 260ms cubic-bezier(.2,.9,.2,1); }
  </style>
</head>
<body>
  <div class="prompt" id="prompt">Tap anywhere to start the soothing music ‚ñ∂Ô∏è</div>

  <!-- Top fixed panel with Yes / No inline (stays at top, as requested) -->
  <div class="top-panel" id="topPanel" role="region" aria-label="Answer panel">
    <div class="label">Anu ‚Äî Will you be my valentine?</div>
    <button id="panelYes" class="panel-btn yes" aria-label="Yes ‚Äî accept">Yes</button>
    <button id="panelNo" class="panel-btn no" aria-label="No ‚Äî shy" aria-disabled="true" tabindex="-1">No</button>
  </div>

  <main class="container" role="main" aria-labelledby="title">
    <header>
      <div class="brand">
        <div class="mark" aria-hidden="true">A‚ù£Ô∏èA</div>
        <div>
          <div style="font-weight:700">Anu & Aji</div>
          <div style="font-size:0.86rem;color:var(--muted)">Wedding: 23rd Aug 2026</div>
        </div>
      </div>
      <nav aria-label="Main navigation">
        <a href="#story">Story</a>
        <a href="#moments">Moments</a>
        <a href="#rsvp">RSVP</a>
      </nav>
    </header>

    <section class="hero" aria-labelledby="title">
      <div class="hero-left">
        <h1 id="title">Anu ‚Äî will you be my valentine?</h1>
        <div class="lead">A little page from Aji celebrating love, our memories, and the promise of forever. Save the date: 23rd Aug 2026.</div>

        <div style="display:flex;gap:12px;flex-wrap:wrap">
          <a class="btn yes" href="#rsvp" style="text-decoration:none;color:#fff">Celebrate Together</a>
          <a class="btn" href="#story" style="background:transparent;border:1px solid rgba(255,255,255,0.06);color:#fff">Read Our Story</a>
        </div>

        <p style="margin-top:14px;color:var(--muted)">Use the top panel to answer. No is shy ‚Äî it slides out of immediate clickable range üòâ</p>
      </div>

      <aside class="hero-right card" aria-labelledby="cta-title">
        <div id="cta-title" style="font-weight:800;font-size:1.1rem">Will you be my valentine?</div>
        <div style="margin-top:8px;color:var(--muted)">Anu & Aji ‚Äî 23rd Aug 2026</div>

        <div style="margin:12px 0;border-radius:10px;overflow:hidden;height:150px">
          <!-- hero image: uses base64 SVG placeholder by default; will attempt to replace with resources/hero.jpg if available -->
          <img id="heroImg" class="responsive" alt="Hero photo placeholder" data-resource="resources/hero.jpg">
        </div>

        <div class="cta-row" role="group" aria-label="Choose">
          <button id="yesBtn" class="btn yes" aria-label="Yes ‚Äî of course">Yes ‚Äî of course</button>
          <button id="noBtn" class="btn no no-hint" aria-label="No ‚Äî shy" aria-disabled="true" tabindex="-1">No</button>
        </div>

        <div style="margin-top:10px;font-size:0.92rem;color:var(--muted)">The No button is shy ‚Äî it likes a little space üòÑ</div>
      </aside>
    </section>

    <div class="grid-2">
      <section id="story" class="section" aria-labelledby="story-h">
        <h3 id="story-h" style="margin-top:0;font-family:'Playfair Display',serif">Our Story</h3>
        <p style="color:var(--muted)">From little smiles to unforgettable moments ‚Äî this page is a small celebration of us. I wrote this for you, Anu, to tell you how much I love you and how excited I am for our future.</p>
        <p style="color:var(--muted)">Everything here is editable later ‚Äî gallery photos in resources/ (the page will try to load them if you drop images there).</p>
      </section>

      <section id="moments" class="section" aria-labelledby="moments-h">
        <h3 id="moments-h" style="margin-top:0;font-family:'Playfair Display',serif">Moments</h3>
        <div class="gallery" aria-hidden="false">
          <!-- photos use base64 SVG placeholders initially; will attempt to load resources/photo1.jpg ... photo6.jpg -->
          <div class="photo"><img class="responsive" alt="moment 1" data-resource="resources/photo1.jpg"></div>
          <div class="photo"><img class="responsive" alt="moment 2" data-resource="resources/photo2.jpg"></div>
          <div class="photo"><img class="responsive" alt="moment 3" data-resource="resources/photo3.jpg"></div>
          <div class="photo"><img class="responsive" alt="moment 4" data-resource="resources/photo4.jpg"></div>
          <div class="photo"><img class="responsive" alt="moment 5" data-resource="resources/photo5.jpg"></div>
          <div class="photo"><img class="responsive" alt="moment 6" data-resource="resources/photo6.jpg"></div>
        </div>
      </section>
    </div>

    <div class="grid-2" style="margin-top:16px">
      <section id="timeline" class="section" aria-labelledby="timeline-h">
        <h3 id="timeline-h" style="margin-top:0;font-family:'Playfair Display',serif">Timeline</h3>
        <div style="display:flex;flex-direction:column;gap:10px;color:var(--muted)">
          <div><strong>First Meet</strong><div class="muted">The coffee that changed everything.</div></div>
          <div><strong>First Trip</strong><div class="muted">A little adventure, lots of laughter.</div></div>
          <div><strong>Will you be my valentine?</strong><div class="muted">Today ‚Äî let's celebrate us.</div></div>
        </div>
      </section>

      <section id="rsvp" class="section" aria-labelledby="rsvp-h">
        <h3 id="rsvp-h" style="margin-top:0;font-family:'Playfair Display',serif">RSVP & Love Notes</h3>
        <p style="color:var(--muted)">Leave a short love note for Anu (local only ‚Äî demo).</p>
        <form id="noteForm" onsubmit="return false" style="margin-top:8px">
          <textarea id="noteText" rows="4" placeholder="Dear Anu..." style="width:100%;padding:10px;border-radius:8px;background:transparent;border:1px solid rgba(255,255,255,0.06);color:#fff"></textarea>
          <div style="display:flex;gap:8px;margin-top:8px">
            <button id="saveNote" class="btn yes" style="flex:0 0 auto">Send love</button>
            <button id="clearNote" class="btn" style="background:transparent;border:1px solid rgba(255,255,255,0.06)">Clear</button>
          </div>
        </form>
        <div id="notesList" style="margin-top:12px"></div>
      </section>
    </div>

    <footer>Made with love by Aji ‚Äî 23rd Aug 2026</footer>

    <div class="hearts" id="hearts" aria-hidden="true"></div>
    <canvas class="confetti" id="confettiCanvas" aria-hidden="true"></canvas>
  </main>

  <!-- YouTube IFrame API (we will set start=20 when creating player) -->
  <script src="https://www.youtube.com/iframe_api"></script>

  <script>
  // -----------------------------
  // Config
  // -----------------------------
  const YT_VIDEO_ID = '2Vv-BfVoq4g'; // Perfect by Ed Sheeran
  const START_AT = 20; // start playback at 20 seconds
  // -----------------------------

  // Utility: build a simple SVG placeholder and return base64 data-uri
  function svgPlaceholder(text, w = 600, h = 350, bg = '#2b0f2f', fg = '#ffdfe8') {
    const svg = `<svg xmlns='http://www.w3.org/2000/svg' width='${w}' height='${h}' viewBox='0 0 ${w} ${h}'>
      <rect width='100%' height='100%' fill='${bg}' rx='12' />
      <g fill='${fg}' font-family='Inter, Arial, sans-serif' font-weight='700' text-anchor='middle'>
        <text x='50%' y='48%' font-size='22'>${text}</text>
      </g>
      <g opacity='0.12'>
        <circle cx='80' cy='60' r='40' fill='#ff6b9a'/>
        <circle cx='520' cy='280' r='60' fill='#ff3b78'/>
      </g>
    </svg>`;
    // base64-encode safely
    try {
      return 'data:image/svg+xml;base64,' + btoa(unescape(encodeURIComponent(svg)));
    } catch (e) {
      // fallback without encode
      return 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent(svg);
    }
  }

  // Set initial placeholders (base64-encoded SVGs) and try to replace with resources/* if available
  function initPlaceholders() {
    const imgs = document.querySelectorAll('img[data-resource]');
    imgs.forEach((img, idx) => {
      // choose label based on id or index
      const label = img.id === 'heroImg' ? 'HERO PHOTO' : `PHOTO ${idx + 1}`;
      const w = img.id === 'heroImg' ? 600 : 400;
      const h = img.id === 'heroImg' ? 350 : 250;
      img.src = svgPlaceholder(label, w, h);
      // attempt to load the resource path specified in data-resource
      const resource = img.getAttribute('data-resource');
      if (!resource) return;
      const test = new Image();
      test.onload = () => { img.src = resource; }; // replace if resource exists and loads
      test.onerror = () => { /* keep placeholder */ };
      // try loading resource
      test.src = resource + '?_=' + (new Date().getTime()); // cache-bust to improve testing during development
    });
  }

  initPlaceholders();

  // -----------------------------
  // UI elements
  // -----------------------------
  const yesBtn = document.getElementById('yesBtn');
  const noBtn = document.getElementById('noBtn');
  const panelYes = document.getElementById('panelYes');
  const panelNo = document.getElementById('panelNo');
  const prompt = document.getElementById('prompt');
  const heartsContainer = document.getElementById('hearts');
  const confettiCanvas = document.getElementById('confettiCanvas');
  const saveNote = document.getElementById('saveNote');
  const noteText = document.getElementById('noteText');
  const notesList = document.getElementById('notesList');

  // Notes (local demo)
  const notes = [];
  saveNote.addEventListener('click', () => {
    const v = noteText.value.trim();
    if (!v) return alert('Write a short love note :)');
    notes.unshift({text: v, time: new Date().toLocaleString()});
    renderNotes();
    noteText.value = '';
  });
  document.getElementById('clearNote').addEventListener('click', () => { noteText.value = ''; });
  function renderNotes(){
    notesList.innerHTML = notes.map(n => `<div style="padding:10px;border-radius:8px;margin-bottom:8px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));"><div style="color:#ffdfe8">${escapeHtml(n.text)}</div><div style="font-size:0.8rem;color:rgba(255,255,255,0.6);margin-top:6px">${n.time}</div></div>`).join('');
  }
  function escapeHtml(s){ return s.replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }

  // -----------------------------
  // "No" behavior (top panel + main panel)
  // - Not clickable (aria-disabled, tabindex=-1)
  // - When hovered or approached, it moves a bit OUT of the immediate clickable area (partially translated)
  // -----------------------------
  function nudgeNo(btn, container) {
    // move the No button slightly outwards (to the right and up) so it becomes harder to click
    // because .top-panel has overflow:hidden, part of the button will be clipped visually if moved beyond bounds
    const rect = container.getBoundingClientRect();
    const btnRect = btn.getBoundingClientRect();
    // compute a movement distance proportional to panel width
    const moveX = Math.min(80, Math.max(36, rect.width * 0.08)); // px
    const moveY = -6 - Math.random() * 6;
    btn.style.transform = `translate(${moveX}px, ${moveY}px)`;
    // small announcement for screen readers
    btn.setAttribute('aria-hidden', 'true');
  }

  function settleNo(btn) {
    btn.style.transform = 'translate(0, 0)';
    btn.setAttribute('aria-hidden', 'false');
  }

  // top panel No
  const topPanel = document.getElementById('topPanel');
  panelNo.setAttribute('tabindex', '-1');
  panelNo.setAttribute('aria-disabled', 'true');
  panelNo.addEventListener('mouseenter', () => nudgeNo(panelNo, topPanel));
  panelNo.addEventListener('mousemove', () => { if (Math.random() < 0.7) nudgeNo(panelNo, topPanel); }, {passive:true});
  panelNo.addEventListener('touchstart', (e) => { e.preventDefault(); nudgeNo(panelNo, topPanel); }, {passive:false});
  panelNo.addEventListener('click', (e) => { e.preventDefault(); e.stopPropagation(); panelNo.animate([{transform: panelNo.style.transform+' translateX(0)'},{transform: panelNo.style.transform+' translateX(-8px)'},{transform: panelNo.style.transform+' translateX(8px)'},{transform: panelNo.style.transform+' translateX(0)'}], {duration:360}); setTimeout(()=>nudgeNo(panelNo, topPanel), 240); });

  // main No
  const cardContainer = document.querySelector('.hero-right');
  noBtn.setAttribute('tabindex', '-1');
  noBtn.setAttribute('aria-disabled', 'true');
  noBtn.addEventListener('mouseenter', () => nudgeNo(noBtn, cardContainer));
  noBtn.addEventListener('mousemove', () => { if (Math.random() < 0.6) nudgeNo(noBtn, cardContainer); }, {passive:true});
  noBtn.addEventListener('touchstart', (e) => { e.preventDefault(); nudgeNo(noBtn, cardContainer); }, {passive:false});
  noBtn.addEventListener('click', (e) => { e.preventDefault(); e.stopPropagation(); noBtn.animate([{transform: noBtn.style.transform+' translateX(0)'},{transform: noBtn.style.transform+' translateX(-10px)'},{transform: noBtn.style.transform+' translateX(10px)'},{transform: noBtn.style.transform+' translateX(0)'}], {duration:420}); setTimeout(()=>nudgeNo(noBtn, cardContainer), 260); });

  // periodic little movement so it stays lively
  setInterval(() => { if (Math.random() < 0.6) { nudgeNo(panelNo, topPanel); nudgeNo(noBtn, cardContainer); setTimeout(() => { settleNo(panelNo); settleNo(noBtn); }, 1800); } }, 3000);

  // Ensure No buttons are not focusable for keyboard users
  panelNo.addEventListener('keydown', (e) => { e.preventDefault(); nudgeNo(panelNo, topPanel); });
  noBtn.addEventListener('keydown', (e) => { e.preventDefault(); nudgeNo(noBtn, cardContainer); });

  // -----------------------------
  // Ambient pad via WebAudio
  // -----------------------------
  let audioCtx, masterGain, oscA, oscB, lfo, filter;
  function createAmbient(){
    try { audioCtx = new (window.AudioContext || window.webkitAudioContext)(); } catch(e) { console.warn('WebAudio not supported'); return; }
    masterGain = audioCtx.createGain(); masterGain.gain.value = 0.0001; masterGain.connect(audioCtx.destination);
    filter = audioCtx.createBiquadFilter(); filter.type='lowpass'; filter.frequency.value = 900; filter.Q.value = 0.6; filter.connect(masterGain);

    oscA = audioCtx.createOscillator(); oscA.type='sine'; oscA.frequency.value = 220;
    const gA = audioCtx.createGain(); gA.gain.value = 0.5; oscA.connect(gA).connect(filter);

    oscB = audioCtx.createOscillator(); oscB.type='sine'; oscB.frequency.value = 220 * Math.pow(2, 4/120);
    const gB = audioCtx.createGain(); gB.gain.value = 0.45; oscB.connect(gB).connect(filter);

    lfo = audioCtx.createOscillator(); lfo.type='sine'; lfo.frequency.value = 0.07;
    const lfoGain = audioCtx.createGain(); lfoGain.gain.value = 200; lfo.connect(lfoGain); lfoGain.connect(filter.frequency);

    const now = audioCtx.currentTime; oscA.start(now); oscB.start(now); lfo.start(now);
    masterGain.gain.cancelScheduledValues(now); masterGain.gain.setValueAtTime(0.0001, now);
    masterGain.gain.exponentialRampToValueAtTime(0.08, now + 3.2);
  }

  function fadeOutAmbient(duration=1.0){
    if (!audioCtx || !masterGain) return;
    const now = audioCtx.currentTime;
    masterGain.gain.cancelScheduledValues(now);
    masterGain.gain.setValueAtTime(masterGain.gain.value, now);
    masterGain.gain.exponentialRampToValueAtTime(0.0001, now + duration);
    setTimeout(()=>{ try{ oscA.stop(); oscB.stop(); lfo.stop(); }catch(e){} }, (duration+0.15)*1000);
  }

  window.addEventListener('load', async () => {
    createAmbient();
    if (audioCtx && audioCtx.state === 'suspended') {
      try { await audioCtx.resume(); prompt.style.display='none'; } catch(e) { prompt.style.display='flex'; }
    } else prompt.style.display='none';
  });

  function ensureAudioStarted(){
    if (!audioCtx) { createAmbient(); return; }
    if (audioCtx.state === 'suspended') {
      audioCtx.resume().then(()=>{ prompt.style.display='none'; }).catch(()=>{ prompt.style.display='flex'; });
    } else prompt.style.display='none';
  }
  document.addEventListener('click', ()=>ensureAudioStarted(), {once:false});
  setTimeout(()=>{ if (audioCtx && audioCtx.state === 'suspended') { prompt.style.display='flex'; const onStart=()=>{ ensureAudioStarted(); prompt.style.display='none'; document.removeEventListener('click', onStart); }; document.addEventListener('click', onStart, {once:true}); } }, 1200);

  // -----------------------------
  // YouTube player for "Perfect" (start at 20s)
  // -----------------------------
  const ytContainer = document.createElement('div');
  ytContainer.id = 'ytPlayer';
  ytContainer.style.position = 'absolute';
  ytContainer.style.left = '-9999px';
  document.body.appendChild(ytContainer);

  let ytPlayer;
  window.onYouTubeIframeAPIReady = function() {
    ytPlayer = new YT.Player('ytPlayer', {
      height: '1', width: '1',
      videoId: YT_VIDEO_ID,
      playerVars: {
        autoplay: 0,
        controls: 0,
        rel: 0,
        modestbranding: 1,
        playsinline: 1,
        start: START_AT  // ensure playback begins at 20s
      },
      events: {
        onReady: function() { /* ready */ },
        onStateChange: function() { /* optional */ }
      }
    });
  };

  // -----------------------------
  // Yes button actions (both top panel and main)
  // - fade ambient, play Perfect at 20s, show celebration
  // -----------------------------
  async function handleYesClick(e) {
    e && e.preventDefault && e.preventDefault();
    if (audioCtx && audioCtx.state === 'suspended') await audioCtx.resume();
    fadeOutAmbient(1.0);
    burstHearts(30);
    startConfetti();

    // attempt to play YouTube at START_AT seconds
    if (typeof YT !== 'undefined' && ytPlayer) {
      try {
        // make sure it's at START_AT
        try { ytPlayer.seekTo(START_AT, true); } catch (seekErr) { /* ignore */ }
        ytPlayer.setVolume(90);
        ytPlayer.playVideo();
      } catch (err) {
        console.warn('YT play failed', err);
        window.open('https://www.youtube.com/watch?v=' + YT_VIDEO_ID + '&t=' + START_AT, '_blank');
      }
    } else {
      // fallback: open YouTube at the timestamp
      window.open('https://www.youtube.com/watch?v=' + YT_VIDEO_ID + '&t=' + START_AT, '_blank');
    }

    showCongratsCard();
  }

  yesBtn.addEventListener('click', handleYesClick);
  panelYes.addEventListener('click', handleYesClick);
  // keyboard support
  yesBtn.addEventListener('keydown', (e) => { if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); handleYesClick(); } });
  panelYes.addEventListener('keydown', (e) => { if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); handleYesClick(); } });

  function showCongratsCard(){
    const o = document.createElement('div');
    o.style.position='fixed'; o.style.left='50%'; o.style.top='50%'; o.style.transform='translate(-50%,-50%)';
    o.style.zIndex=220; o.style.padding='22px'; o.style.borderRadius='14px';
    o.style.background='linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01))';
    o.style.boxShadow='0 18px 40px rgba(0,0,0,0.6)'; o.style.textAlign='center'; o.style.color='#fff';
    o.innerHTML = `<div style="font-size:1.5rem;font-weight:800">Yes! üíç</div>
                   <div style="margin-top:8px;color:#ffdfe8">Anu ‚Äî will you marry me? ‚Äî 23 Aug 2026</div>
                   <div style="margin-top:14px;font-size:0.95rem;color:#ffdfe8">Playing "Perfect" (from 00:20) now...</div>`;
    document.body.appendChild(o);
    setTimeout(()=>{ o.style.transition='opacity 600ms'; o.style.opacity='0'; setTimeout(()=>o.remove(),650); },7000);
  }

  // -----------------------------
  // Visuals: hearts & confetti
  // -----------------------------
  function createHeartSVG(color='#ff6b9a'){
    const svg = document.createElementNS('http://www.w3.org/2000/svg','svg');
    svg.setAttribute('width','18'); svg.setAttribute('height','18'); svg.setAttribute('viewBox','0 0 24 24');
    svg.innerHTML = `<path fill="${color}" d="M12 21s-7.33-4.75-9.17-7.03C.9 11.9 2.02 7.5 5.5 6.2 7.1 5.6 8.9 6 10 7.2 11.1 6 12.9 5.6 14.5 6.2c3.48 1.3 4.6 5.7 2.67 7.77C19.33 16.25 12 21 12 21z"/>`;
    return svg;
  }

  function burstHearts(count=12){
    for (let i=0;i<count;i++){
      const el = createHeartSVG(['#ff6b9a','#ff3b78','#ffd6e0'][Math.floor(Math.random()*3)]);
      el.classList.add('heart');
      const left = Math.random()*100;
      el.style.left = left + '%';
      el.style.bottom = (Math.random()*20 - 10) + 'vh';
      el.style.animationDuration = (5 + Math.random()*6) + 's';
      heartsContainer.appendChild(el);
      setTimeout(()=> el.remove(), 9000);
    }
  }
  setInterval(()=> burstHearts(4), 3800);

  function startConfetti(){
    const canvas = confettiCanvas;
    if (!canvas.getContext) return;
    const ctx = canvas.getContext('2d');
    let W = canvas.width = window.innerWidth;
    let H = canvas.height = window.innerHeight;
    const pieces = [];
    const colors = ['#ff6b9a','#ffd6e0','#ffb3c7','#ffffff'];
    function resetPiece(p){
      p.x = Math.random()*W; p.y = -20 - Math.random()*H*0.2; p.size = 6 + Math.random()*8;
      p.color = colors[Math.floor(Math.random()*colors.length)]; p.speed = 1 + Math.random()*3; p.rot = Math.random()*360;
      p.velX = (Math.random()-0.5)*2; p.velY = p.speed;
    }
    for (let i=0;i<140;i++){ const p={}; resetPiece(p); pieces.push(p); }
    let running = true;
    function frame(){
      ctx.clearRect(0,0,W,H);
      for (let p of pieces){
        p.x += p.velX; p.y += p.velY; p.rot += 6;
        ctx.save(); ctx.translate(p.x,p.y); ctx.rotate(p.rot * Math.PI/180);
        ctx.fillStyle = p.color; ctx.fillRect(-p.size/2, -p.size/2, p.size, p.size); ctx.restore();
        if (p.y > H + 50) resetPiece(p);
      }
      if (running) requestAnimationFrame(frame);
    }
    frame();
    setTimeout(()=>{ running=false; ctx.clearRect(0,0,W,H); }, 8500);
    window.addEventListener('resize', ()=>{ W = canvas.width = window.innerWidth; H = canvas.height = window.innerHeight; });
  }

  // -----------------------------
  // Replace placeholders with resources/* if available (attempt)
  // -----------------------------
  function tryReplaceResources() {
    const imgs = document.querySelectorAll('img[data-resource]');
    imgs.forEach(img => {
      const resource = img.getAttribute('data-resource');
      if (!resource) return;
      const tester = new Image();
      tester.onload = () => { img.src = resource; };
      tester.onerror = () => { /* keep base64 placeholder */ };
      tester.src = resource + '?_=' + (new Date().getTime());
    });
  }
  // run shortly after load to give local resources a chance
  window.addEventListener('load', () => { setTimeout(tryReplaceResources, 600); });

  // -----------------------------
  // Fallback if YouTube API not ready
  // -----------------------------
  setTimeout(()=> {
    if (typeof YT === 'undefined') {
      const info = document.createElement('div');
      info.style.fontSize='0.9rem'; info.style.color='#ffdfe8'; info.style.marginTop='10px';
      info.innerHTML = 'If the music does not start, <a href="https://www.youtube.com/watch?v='+YT_VIDEO_ID+'&t='+START_AT+'" target="_blank" style="color:#fff;text-decoration:underline">click here to play "Perfect" from 00:20</a>.';
      document.querySelector('.container').appendChild(info);
    }
  }, 2000);

  // -----------------------------
  // Initialize base64 SVG placeholders (must run after functions defined)
  // -----------------------------
  initPlaceholders();

  // Accessibility: small ARIA live region to announce No button playfulness
  const live = document.createElement('div');
  live.setAttribute('aria-live','polite');
  live.style.position='absolute'; live.style.left='-9999px';
  document.body.appendChild(live);
  function announce(msg){ live.textContent = msg; }

  // Make nudge functions also announce
  const _nudgeNo = nudgeNo;
  nudgeNo = function(btn, container) { _nudgeNo(btn, container); announce('No button is shy'); };

  // Announce when Yes is clicked (for screen readers)
  function announceYes() { announce('She said yes! Congratulations.'); }
  panelYes.addEventListener('click', announceYes);
  yesBtn.addEventListener('click', announceYes);

  // small safety: reset No buttons when clicking elsewhere
  document.addEventListener('click', () => { settleNo(panelNo); settleNo(noBtn); });

  // End of script
  </script>
</body>
</html>
